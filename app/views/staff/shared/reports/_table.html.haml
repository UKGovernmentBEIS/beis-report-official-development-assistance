- if grouped_reports.empty?
  = render partial: "staff/shared/reports/table_empty"
- else
  %table.govuk-table
    %caption.govuk-table__caption.govuk-table__caption--m
      = t("table.title.report.#{type}")
    %thead.govuk-table__head
      %tr.govuk-table__row
        - if current_user.service_owner?
          %th.govuk-table__header
            = t("table.header.report.organisation")
        %th{class: "govuk-table__header govuk-!-width-one-quarter"}
          =t("table.header.report.financial_quarter")
        %th.govuk-table__header
          =t("table.header.report.description")
        %th.govuk-table__header
          =t("table.header.report.fund")
        - if type == "current"
          %th.govuk-table__header
            =t("table.header.report.state")
          %th.govuk-table__header
            =t("table.header.report.deadline")
        %th.govuk-table__header

    %tbody.govuk-table__body
      - grouped_reports.each do |organisation, reports|
        - reports.each_with_index do |report, index|
          %tr.govuk-table__row{id: report.id}
            - if index == 0
              %th.govuk-table__cell{rowspan: reports.count, scope: "rowgroup", id: report.organisation.id}= report.organisation.name
            %td.govuk-table__cell= report.financial_quarter_and_year
            %td.govuk-table__cell= report.description
            %td.govuk-table__cell= report.fund.title
            - if type == "current"
              %td.govuk-table__cell= report.state
              %td.govuk-table__cell= report.deadline
            %td.govuk-table__cell
              - if policy(:report).edit?
                = a11y_action_link(t("default.link.edit"), edit_report_path(report), report.description)
              = a11y_action_link(t("default.link.view"), report_path(report), report.description)
